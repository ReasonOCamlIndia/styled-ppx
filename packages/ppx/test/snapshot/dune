(library
 (name StyledPpxTestNativeSnapshot)
 (library_flags (-linkall -g))
 (libraries styled-ppx.lib)
 (preprocess
  (pps styled-ppx.lib)
 )
)

(rule
 (targets pp.result)
 (deps test.re.pp.ml)
 (action
  (with-stdout-to
   %{targets}
   (run refmt --parse=binary %{deps})
  )
 )
)

(rule
 (alias snapshot_test)
 (action
  (diff test.expected.re pp.result)
 )
)
