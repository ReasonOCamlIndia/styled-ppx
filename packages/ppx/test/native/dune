(library
 (name StyledPpxTestNativeLib)
 (modules
  (:standard \ runner static_css_tests))
 (library_flags
  (-linkall -g))
 (libraries MockBsCss rely.lib styled-ppx.lib ppxlib)
 (preprocess
  (pps ppxlib.metaquot styled-ppx.lib)))

(executable
 (name runner)
 (modules runner)
 (libraries StyledPpxTestNativeLib styled-ppx-css-parser)
 (preprocess
  (pps ppxlib.metaquot styled-ppx.lib)))

; type check

(rule
 (alias native_typecheck_test)
 (targets static_css_tests.ml)
 (deps ./runner.exe)
 (action
  (run %{deps})))

(library
 (name StyledPpxTestNativeTypeCheck)
 (libraries MockBsCss)
 (modules static_css_tests)
 (preprocess
  (pps styled-ppx.lib ppxlib.metaquot)))

(rule
 (alias native_typecheck_test)
 (deps
  .StyledPpxTestNativeTypeCheck.objs/byte/styledPpxTestNativeTypeCheck__Static_css_tests.cmi)
 (action ; this is only because a action is required
  (run "true")))
